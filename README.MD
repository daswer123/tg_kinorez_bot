# Kinorez_bot

Telegram бот для извлечения и отправки фрагментов с YouTube видео.

## Функциональность

- Принимает текстовые сообщения с YouTube URL и таймкодами
- Автоматически извлекает URL и таймкоды с помощью LLM (Language Model)
- Загружает видео с YouTube
- Вырезает указанный фрагмент
- Отправляет обработанное видео обратно пользователю
- Имеет систему авторизации пользователей (PostgreSQL)
- Поддерживает авторизацию по паролю
- Собирает статистику использования

## Установка

1. Клонируйте репозиторий:
```bash
git clone <repository_url>
cd test_aiogram
```

2. Создайте файл .env на основе примера:
```bash
cp env.example .env
```

3. Отредактируйте .env файл, заполнив необходимые данные:
   - TELEGRAM_API_ID
   - TELEGRAM_API_HASH
   - TELEGRAM_TOKEN
   - OPENROUTER_API_KEY
   - PROXY_URL
   - POSTGRES_PASSWORD
   - POSTGRES_USER
   - POSTGRES_DB
   - AUTH_PASSWORD
   - ADMIN_USERS (список ID администраторов через запятую)

4. Запустите бота в продакшн режиме:
```bash
docker-compose up -d
```

## Использование

1. При первом использовании бота отправьте `/start`
2. Если вы не авторизованы, нажмите на кнопку "Запросить доступ"
3. Введите пароль для получения доступа к боту
4. После авторизации, отправьте боту сообщение с ссылкой на YouTube видео и таймкодами начала и конца
5. Бот автоматически распознает ссылку и таймкоды с помощью LLM
6. Бот скачает и обрежет видео, а затем отправит его обратно

Пример:
```
https://www.youtube.com/watch?v=dQw4w9WgXcQ 00:30 01:00
```

## Особенности

- Использует Aiogram 3 для работы с Telegram Bot API
- Использует yt-dlp для загрузки видео с YouTube
- LLM (Language Model) для извлечения структурированных данных из текста
- Поддерживает скачивание видео в высоком разрешении (до 8K, если доступно)
- Асинхронная работа с PostgreSQL через asyncpg
- Система авторизации пользователей по паролю и сбор статистики 